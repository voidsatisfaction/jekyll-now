---
layout: post
title: scheme test
---

스킴 코드 테스트입니다.

```scheme
(define (divisors num)
  (define (divisors-iter num index result)
    (cond ((= num 1) result)
          ((and (zero? (modulo num index)) (null? result))
           (divisors-iter (/ num index) index (cons index result)))
          ((and (zero? (modulo num index)) (= (car result) index))
           (divisors-iter (/ num index) index result))
          ((zero? (modulo num index))
           (divisors-iter (/ num index) index (cons index result)))
          (else
           (divisors-iter num (+ index 1) result))))
  (divisors-iter num 2 '()))

(define (euler-value num)
  (define (euler-value-iter divisors result)
      (if (null? divisors)
          result
          (let ((p (car divisors)))
            (euler-value-iter (cdr divisors) (* result (/ p (- p 1)))))))
  (euler-value-iter (divisors num) 1))

(define (max-euler-val? index max answer)
  (let ((value (euler-value index)))
    (cond ((= index 1) answer)
          ((> value max) (max-euler-val? (- index 1) value index))
          (else (max-euler-val? (- index 1) max answer)))))
          
```
